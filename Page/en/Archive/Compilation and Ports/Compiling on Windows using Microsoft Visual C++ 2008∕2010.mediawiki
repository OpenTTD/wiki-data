This article gets you started on compiling OpenTTD using Microsoft Visual C++ 2008 Express Editions.

=Required software=
:* [http://www.microsoft.com/express/download/default.aspx Microsoft® Visual C++ 2008 Express Editions] ''(current: Final)''
:* [http://www.microsoft.com/downloads/details.aspx?FamilyID=529f03be-1339-48c4-bd5a-8506e5acf571 Microsoft® DirectX SDK - August 2007 or earlier] ''(needed for DirectMusic, more later)''
:* [http://www.microsoft.com/downloads/details.aspx?FamilyID=572be8a6-263a-4424-a7fe-69cff1a5b180 Microsoft® DirectX SDK - November 2007 or later] ''(current: March 2008)''


:* [http://sourceforge.net/project/showfiles.php?group_id=103924&package_id=114307 Openttd-useful.zip]
:** openttd_useful.zip is a collection of files of varying age. For the latest zlib, libpng and FreeType files you can browse their websites below.
:** [http://www.zlib.net/ zlib]
:** [http://sourceforge.net/project/showfiles.php?group_id=23617&package_id=16183 GnuWin32 libpng]
:** [http://gnuwin32.sourceforge.net/downlinks/freetype.php GnuWin32 FreeType]


:...and of course the newest source from <code>svn://svn.openttd.org/trunk</code>. You have to have a SVN-client to download the source. Pick either of the following two. For SVN novices TortoiseSVN is highly recommended:

:* [http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=91 Command line version] ''(Subversion 1.4.5 Win32 binaries)''
:* [http://tortoisesvn.tigris.org/download.html GUI TortoiseSVN]


:'''Note:''' This guide has been made on Windows Vista 32bit.

=Installing=

===Microsoft® Visual C++ 2008 Express Editions===
:If you just need to compile OpenTTD it's enough if you select '''"Graphical IDE"''' (see the image below).

:[[File:en/Archive/Compilation and Ports/Microsoft Visual Cpp 2008 Express Editions.png]]

===Microsoft® DirectX SDK===
:'''Install the version November 2007 or later'''
:From the components screen remove the documentation and sample source code you'll save a lot of space. They're pretty useless if you just need to compile OpenTTD (see the image below).

:[[File:en/Microsoft DirectX SDK.png]]

=Copying from OpenTTD needed includes and libraries=
===openttd_useful.zip===
:Now extract the [http://sourceforge.net/project/showfiles.php?group_id=103924&package_id=114307 Openttd-useful.zip] file and copy:
:* The contents of the <code>include</code> folder to <code>C:\Program Files\Microsoft Visual Studio 9.0\VC\include\</code>.
:* The contents of the <code>library</code> folder to <code>C:\Program Files\Microsoft Visual Studio 9.0\VC\lib\</code>.

===Microsoft® DirectX SDK - August 2007===
: '''Information''': The DirectX SDK from November 2007 is the first one which supports Microsoft® Visual Studio 2008. But it's also the first version which doesn't support DirectMusic which is needed to compile OpenTTD. That is why we must copy the missing files from an older version, prefered the final one for DirectMusic: 'August 2007'.
:* Extract ('''no double-click, do not install''') <code>dxsdk_aug2007.exe</code> in an extra directory and you get a file called <code>dxsdk_aug2007.exe</code> (yes that's right, both files have the same name).
:* Extract the second <code>dxsdk_aug2007.exe</code> in an extra directory.
:* Now copy following 9 files from <code>.\dxsdk_aug2007\dxsdk_aug2007\Include\</code> to <code>C:\Program Files\Microsoft DirectX SDK (November 2007)\Include</code> ('''note''': Please update the paths as necessary):
:** dls1.h
:** dmdls.h
:** dmerror.h
:** dmksctrl.h
:** dmplugin.h
:** dmusbuff.h
:** dmusicc.h
:** dmusicf.h
:** dmusici.h



=Compiling=
:* Open <code>projects/openttd_vs90.sln</code>. This will open your IDE with the project loaded.
:* To compile a non-debug version, go to <code>Build -> Configuration Manager</code> and select <code>Release for OpenTTD</code>.
:* Press <code>F7</code>, or go to <code>Build -> Build Solution</code>.

=Credits=

:* OpenTTD Developers for the great game.
:* Microsoft® for the the SDKs and Visual C++ 2008 Express Edition.
:* BigBB (Markus Bartelt) for creating this guide.
:* Sebastian and Desolator (aka Mircea Chirea) for creating/updating the Microsoft® Visual C++ 2005 Express guide.

[[Category:en/Development]]
[[Category:en/Development/Compiling OpenTTD]]
[[Category:en/Development/Microsoft Visual C++]]
[[Category:en/Archive/Program Descriptions]]