This article gets you started on compiling OpenTTD using Microsoft Visual C++ 2008 Express Editions.

=Required software=
:* [http://www.microsoft.com/express/download/default.aspx Microsoft® Visual C++ 2008 Express Editions] ''(current: Final)''
:* [http://www.microsoft.com/downloads/details.aspx?FamilyID=529f03be-1339-48c4-bd5a-8506e5acf571 Microsoft® DirectX SDK - August 2007 or earlier] ''(needed for DirectMusic, more later)''


:* [http://binaries.openttd.org/extra/openttd-useful/ Openttd-useful.zip] ''(current: 2.2)''
:** openttd_useful.zip is a collection of files of varying age. For the latest zlib, libpng and FreeType files you can browse their websites below.
:** [http://www.zlib.net/ zlib]
:** [http://sourceforge.net/project/showfiles.php?group_id=23617&package_id=16183 GnuWin32 libpng]
:** [http://gnuwin32.sourceforge.net/downlinks/freetype.php GnuWin32 FreeType]
:** [http://icu-project.org/download/ ICU4C]

:...and of course the newest source from <code>svn://svn.openttd.org/trunk</code>. You need to have a SVN-client to download the source from the SVN server. Pick either of the following two. For SVN novices TortoiseSVN is highly recommended:

:* [http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=91 Subversion command line version] binares ''(current: 1.5.6)''
:* [http://tortoisesvn.net/downloads GUI TortoiseSVN] ''(current: 1.6.0)''

:'''Note:''' This guide has been made on Windows Vista 32bit (also compatible with Windows Vista x64).

=Installing=

===Microsoft® Visual C++ 2008 Express Editions===
:If you just need to compile OpenTTD it's enough if you don't select any options (see the image below).

:[[File:en/Archive/Compilation and Ports/Microsoft Visual Cpp 2008 Express Editions.png]]

===Microsoft® DirectX SDK===
:'''Install the version August 2007 or earlier'''
:From the components screen remove the documentation and sample source code you'll save a lot of space. They're pretty useless if you just need to compile OpenTTD (see the image below). Note:You should not use a version newer then August 2007 as DirectMusic is no longer support as of the November 2007 release.

:As August 2007 or earlier installer doesn't support Microsoft® Visual Studio 2008, you will have to set up the VC++ directories manually.

:Go to <code>Tools -> Options</code>, then to <code>Projects and Solutions -> VC++ Directories</code>. Add the following lines:

:Include files:
:* C:\Program Files\Microsoft DirectX SDK\Include

:Library files:
:* C:\Program Files\Microsoft DirectX SDK\Lib\x86

:'''Note:''' Please update the paths as necessary.

: '''Alternative''': If you are willing to compile without support for MIDI music you will not be needing the DirectX SDK. To disable music, remove the WIN32_ENABLE_DIRECTMUSIC_SUPPORT preprocessor definition from the openttd project using the project properties dialog.

=Copying from OpenTTD needed includes and libraries=
===openttd_useful.zip===
:*Extract the [http://binaries.openttd.org/extra/openttd-useful/ Openttd-useful.zip] file and copy the content to some <code><personal folder></code>.
:*Now you need to tell Visual C++ where the files are located. Navigate to ''Tools > Options > Projects and Solutions > VC++ Directories'':<br />
:**Select Platform '''Win32''' (Be sure that all your entries are '''before''' any SDK folder!):
:***Select '''Include Files''', press the new folder button and add the folder <code><personal folder>\shared\include</code> to the list.
:***Select '''Library Files''', press the new folder button and add the folder <code><personal folder>\win32\library</code> to the list.
:**Select Platform '''x64''' (Skip if it isn't available! Again be sure that all your entries are '''before''' any SDK folder!) :
:***Select '''Include Files''', press the new folder button and add the folder <code><personal folder>\shared\include</code> to the list.
:***Select '''Library Files''', press the new folder button and add the folder <code><personal folder>\win64\library</code> to the list.<br />

:Don't forget to replace <code><personal folder></code> with the folder where you extracted openttd-useful.zip.



=Compiling=
:* Open <code>projects/openttd_vs90.sln</code>. This will open your IDE with the project loaded.
:* To compile a non-debug version, go to <code>Build -> Configuration Manager</code> and select <code>Release for OpenTTD</code>.
:* Add the DirectX headers subdirectory through the openttd project properties -> C/C++ -> General -> Additional Include Directories
:* Add the DirectX SDK Lib subdirectory through the openttd project properties -> Linker -> General -> Additional Library Directories
:* Copy the data folder from your normal OpenTTD installation directory, typically <code>C:/Program Files/OpenTDD</code>, and paste the folder into <code>objs/Win32/Debug</code>.
:* Press <code>F7</code>, or go to <code>Build -> Build Solution</code>.

=Credits=

:* OpenTTD Developers for the great game.
:* Microsoft® for the the SDKs and Visual C++ 2008 Express Edition.
:* Sebastian and Desolator (aka Mircea Chirea) for creating/updating the Microsoft® Visual C++ 2005 Express guide.

[[Category:en/Development]]
[[Category:en/Development/Compiling OpenTTD]]
[[Category:en/Development/Microsoft Visual C++]]
[[Category:en/Archive/Program Descriptions]]