[[Translation:en/Archive/Compilation and Ports/Compiling on GNU‚àïLinux and üüâBSD]]
[[Category:fr/Development/Compiler OpenTTD]]

Un guide rapide pour d√©marrer avec le d√©veloppement de OpenTTD sur Linux et autres syst√®mes *nix. Pour une aide sur la compilation sur diverses plateformes, rejoignez [irc://irc.oftc.net/openttd.compile #openttd] sur OFTC.

==Logiciels requis==

La plupart des paquets requis pour le d√©veloppement (comme gcc) devraient d√©j√† √™tre install√©s sur votre machine. Vous aurez besoin de ces paquets en plus de gcc, make et les outils de construction habituels.
Outre ceux-ci, OpenTTD a besoin que les biblioth√®ques de d√©veloppement SDL soient install√©es. En option, mais extr√™mement recommand√©, est l'installation des fichiers de d√©veloppement de zlib, qui compressent les sauvegardes (ne pas les avoir ne rend pas seulement votre jeu plus gros, mais vous emp√™che √©galement de charger des sauvegardes compress√©es ou de rejoindre des parties en r√©seau avec compression, soit toutes les parties en r√©seau).
Plus tard, OpenTTD pourra utiliser les fichiers de d√©veloppement de linpng pour produire des captures d'√©cran en PNG au lieu de BMP.

De plus, si vous voulez aussi √† jour que possible, vous devriez installer le client subversion pour acc√©der au dernier code de notre d√©p√¥t subversion.

=== Mandriva ===
(test√© sur Mandriva 2009 Printemps)

* gcc (requis)
* gcc-c++ (requis)
* libSDL-devel (requis)
* zlib1-devel (recommand√©, pour la compression des sauvegardes) 
* libpng-devel (optionnel, pour les captures d'√©cran en PNG) 
* subversion (optionnel, pour obtenir les derni√®res sources) 
* patch (optionnel, pour corriger)
* patchutils (optionnel, pour la cr√©ation d'ajouts)

Ou entrez la commande:
 <code>urpmi gcc gcc-c++ libsdl-devel zlib1-devel subversion patch patchutils</code>

=== Debian et Ubuntu ===
* build-essential (pour les compilateurs)
* libsdl1.2-dev (requis)
* dpatch (requis pour au moins 0.4.8)
* zlib1g-dev (recommand√©, pour la compression des sauvegardes)
* liblzo2-dev (recommand√©, pour la compression des sauvegardes)
* liblzma-dev (recommand√©, pour la compression des sauvegardes)
* libpng12-dev (optionnel, pour les captures d'√©cran en PNG)
* subversion (optionnel, pour obtenir les derni√®res sources)
* timidity (optionnel, pour jouer la musique)
* libsdl1.2debian-pulseaudio (requis pour Ubuntu 9.04 et au-del√†; voyez aussi {{en/Flyspray|3294}})
* libfontconfig1-dev (optionnel, pour les fontes TrueType)

Ou entrez la commande:
 <code>sudo apt-get install build-essential libsdl1.2-dev subversion zlib1g-dev liblzo2-dev timidity dpatch liblzma-dev libfontconfig-dev</code>
Et pour Ubuntu 9.04 et sup√©rieur:
 <code>sudo apt-get install libsdl1.2debian-pulseaudio</code>

Au moins une instance du paquet "libsdl1.2debian-all" √©tait requise pour une installation compl√®te avec une version PowerPC de Debian. Sans ce paquet, seule le serveur d√©di√© peut √™tre compil√©. [http://www.tt-forums.net/viewtopic.php?f=31&t=37680]
Remarque: Ce n'√©tait pas n√©cessaire sur un serveur Debian 2.6.26-2-amd64 personnalis√© en compilant la r20739.

=== Fedora === 
(test√© sur FC6 et Fedora 7, 8 & 11)
* gcc
* gcc-c++
* SDL-devel
* zlib-devel
* subversion (optionnel, pour avoir les derni√®res sources)
* timidity++ (optionnel, pour les pistes de son)
* esound (optionnel, pour les pistes de son)

Alternativement, si vous avez yum d'install√©, tapez la commande suivante sous root:
* <code>$ yum install gcc gcc-c++ SDL-devel zlib-devel subversion timidity++ esound -y</code>



=== openSUSE ===
Utilisez YaST pour t√©l√©charger:
* gcc-c++
* SDL-devel
* zlib-devel
* libpng-devel
* libicu-devel
* lzo-devel 
* freetype2-devel
* xz-devel (pour openttd 1.1)
* subversion (optionnel, pourrait aussi √™tre mercurial ou git)
* timidity

Vous pouvez utiliser l'outil en ligne de commande `zypper' √©galement:
* <code>$ zypper install gcc-c++ SDL-devel zlib-devel libpng-devel libicu-devel lzo-devel freetype2-devel subversion timidity</code> <br/>or <code>$ zypper source-install openttd</code>

=== Gentoo ===

En tant que root, lancez:
<code>$ emerge --onlydeps -av openttd</code>
et il installera toutes les d√©pendances de OpenTTD.

Si vous voulez utiliser la version la plus courante (soit Tronc/SVN), lancez ce qui suit sous root:
 emerge subversion

=== Arch Linux ===

Sous root, lancez:
 pacman -S openttd
Cela installera OpenTTD et toutes ses d√©pendances. Les ensembles de graphismes (openttd-opengfx) et de sons (openttd-opensfx) libres sont aussi disponibles dans les d√©p√¥ts officiels.

Les PKGBUILDs openttd-beta, openttd-svn et openttd-32bpp sont disponibles dans [http://aur.archlinux.org/packages.php?O=0&K=openttd AUR].

=== FreeBSD ===

Pour rechercher, compiler et installer toutes les d√©pendances n√©cessaires, sous root, lancez:
 
<code>cd /usr/ports/games/openttd && make depends clean </code>

Si vous allez compiler OpenTTD depuis subversion, alors, sous root, lancez:

<code> cd /usr/ports/devel/subversion && make install clean </code>

=== NetBSD ===

Pour rechercher, compiler et installer toutes les d√©pendances n√©cessaires, lancez:

<code>cd /usr/pkgsrc/games/openttd && make depends clean</code>

Si vous allez compiler OpenTTD depuis subversion, alors lancez:

<code> cd /usr/pkgsrc/devel/subversion-base && make install clean</code>

Vous devriez fournir le mot de passe root une fois que le code est compil√© et pr√™t √† l'installation.


== Obtenir les sources ==
=== Versions ===
Vous pouvez t√©l√©charger les fichiers source .tar.gz depuis le [http://www.openttd.org/download-stable site web OpenTTD]. Extraire le fichier tar vous donnera un r√©pertoire appel√© openttd-<version>, o√π <version> est la version t√©l√©charg√©e. Entrez dans ce r√©pertoire et vous serez pr√™ts pour l'√©tape 3.

=== Constructions nocturnes ===
Similaire √† l'option des versions livr√©es ci-dessus; vous pouvez t√©l√©charger la derni√®re photo des sources (faite chaque jour √† 19h00 GMT) depuis le [http://www.openttd.org/download-trunk site web de OpenTTD]. D√©compactez et entrez dans le r√©pertoire o√π vous l'avez fait. Puis passez √† l'√©tape 3.

=== Version la plus √† jour (c.√†.d. Tronc/SVN) ===
La version la plus √† jour du code officiel est stock√©e dans notre d√©p√¥t subversion. Subversion facilite le tra√ßage des diff√©rentes versions et fournit un emplacement unique facilement partag√© pour votre code. Pour vous en tant qu'utilisateur, cela veut dire que vous pouvez rapidement obtenir le code source le plus r√©cent.

==== Chargement initial ====

Pour obtenir le code source depuis le serveur subversion, tapez:

<code>$ svn checkout svn://svn.openttd.org/trunk openttd</code>

sur la ligne de commande pour r√©cup√©rer le code dans le r√©pertoire <code>openttd/</code>. Nous ferons r√©f√©rence √† ce r√©pertoire comme votre "copie de travail" dans la suite. √âgalement, toutes les commandes svn donn√©es d√©sormais supposent que votre r√©pertoire de travail est le r√©pertoire <code>openttd/</code>.

Vous pouvez maintenant sauter √† l'√©tape 3 si vous voulez simplement compiler la derni√®re version.

==== Mise √† jour ====

Si vous avez pr√©c√©demment charg√© le code et qu'une nouvelle version est disponible (donc, de nouvelles modifications ont √©t√© valid√©es), vous pouvez mettre √† jour votre copie de travail √† la derni√®re version. Dans celle-ci, lancez ce qui suit:

<code>$ svn update</code>

√âgalement, si vous avez fait des changements en local au code source, elles seront pr√©serv√©es et fusionn√©es avec les modifications dans svn. En cas de conflit entre les modifications, ils seront signal√©s comme en conflit (marqu√©s "C" dans <code>svn status</code>) (en pr√©servant toujours vos modifications locales). Pour plus d'information sur la r√©solution des conflits, regardez le livre SVN sur [http://subversion.tigris.org].

====Cr√©er un fichier d'ajout====

Si vous avez fait des changements dans votre source et que vous voulez les partager ou les charger comme ajout, vous pouvez demander √† SVN de g√©n√©rer un fichier diff.
La commande

<code>$ svn diff > mypatch.diff</code>

cr√©e un fichier diff (aussi appel√© "patch") que vous pouvez soumettre aux d√©veloppeurs pour partager vos am√©liorations.

====Retour arri√®re====

Vous pouvez d√©faire les changements sur un fichier avec:

<code>$svn revert nom_fichier</code>

ou sur tout votre r√©pertoire de travail avec:

<code>$svn revert -R .</code>

==== Appliquer un ajout ====

Pour appliquer un ajout (un fichier diff) au code source, chargez votre code source avec la r√©vision du fichier d'ajout. Disons que celui-ci a √©t√© fait pour la r1234. Vous pouvez voir cela dans les premi√®res lignes du fichier:
<code>
 Index: foo.c
 ===================================================================
 --- foo.c (revision 1234)
 +++ foo.c (working copy)
 </code>
Pour mettre √† jour votre code source en r12334, tapez

<code>$ svn update -r 1234</code>

Puis vous √™tes pr√™t √† fusionner le fichier d'ajout:

<code>$ patch -p0 < mydiff.diff</code>

Maintenant (optionnel), mettez √† jour le code source avec la derni√®re r√©vision par:

<code>$ svn update</code>

Si cela am√®ne des conflits (fichiers marqu√©s avec "C"), pas de chance, l'ajout ne fonctionne pas pour la derni√®re r√©vision (vous pouvez toujours faire un retour arri√®re et retenter l'ajout en sautant cette derni√®re √©tape et en jouant avec une ancienne version).

== Compiler et ex√©cuter ==

Compilez OpenTTD avec:

<code>$ ./configure</code>

Cela cr√©era un Makefile, puis:

<code>$ make</code>

Si vous avez modifi√© des fichiers ou mis √† jour votre source, cela ne recompilera que le code modifi√©.

== Fichiers de donn√©es d'origine de TTD optionnels ==

Copiez les fichiers GRF de Transport Tycoon Deluxe dans le r√©pertoire <code>data/</code>:

'''Version Windows'''
*sample.cat
*trg1r.grf
*trgcr.grf
*trghr.grf
*trgir.grf
*trgtr.grf

'''Version DOS'''
*SAMPLE.CAT
*TRG1.GRF
*TRGC.GRF
*TRGH.GRF
*TRGI.GRF
*TRGT.GRF

== Lancement ==
Vous pouvez lancer OpenTTD avec:

<code>$ cd bin</code>

<code>$ ./openttd</code>

La commande <code>cd</code> vous am√®ne dans le r√©pertoire <code>bin</code>, o√π le programme <code>openttd</code> a √©t√© mis. Dans ce r√©pertoire, d√©marrez le programme.


√âgalement, vous pouvez installer le jeu dans <code>/usr/local/</code> o√π ailleurs, mais c'est essentiellement pour les empaqueteurs. cela requiert une connaissance un peu plus pouss√©e de l'installation de logiciels et de OpenTTD; regardez donc le Makefile pour des conseils.

== Jouer les pistes de son==

Si vous voulez la musique d'origine de TTD, vous avez besoin de copier tout le r√©pertoire <code>gm/</code>. De plus, le programme TiMidity est requis:

Sous Debian/Ubuntu

T√©l√©chargez "timidity & freepats"

 sudo apt-get install timidity freepats

Lancez "Param√®tres syst√®me" puis cliquez sur le "Syst√®me audio"; choisissez l'onglet "Mat√©riel", cliquez sur "Choisir le p√©riph√©rique Midi", puis choisissez "Timidity port 0 - Alsa device" (conseil: ce peut √™tre autre chose; cherchez simplement timidity), puis cliquez sur le bouton "Appliquer".

Sous Fedora

Installez timidity++ 

 yum install timidity++ 

Timidity veut parler √† ESD, donc vous devrez "activer le logiciel de mixage du son (ESD)" (Syst√®me &rarr; Pr√©f√©rences &rarr; Son).

Pour lancer OpenTTD avec le support de la musique, tapez:

<code>$ ./openttd -m extmidi</code>

== Paquet Debian ==
Vous devriez pouvoir construire un paquet Debian depuis la derni√®re source en utilisant le r√©pertoire debian fourni. Vous pouvez remplacer l'√©tape 3 par ceci. Ce r√©pertoire Debian est, selon les standards de OpenTTD, mis dans le r√©pertoire <code>os/</code>, et doit √™tre tout d'abord d√©plac√© un niveau plus haut:

<code>$ mv os/debian .</code>

Apr√®s cela, utilisez les outils habituels de Debian pour construire le paquet:

<code>$ dpkg-buildpackage -rfakeroot -uc -us</code>

L'installation peut alors √™tre faite en ex√©cutant (sous root):
<code>$ dpkg -i ../openttd-<version>_<something>.deb</code>

OpenTTD est maintenant install√©.

Dans l'√©tape 3, vous devez copier les fichiers de donn√©es dans <code>/usr/share/games/openttd/data</code>, car ils ne sont pas inclus dans le .deb √† cause de probl√®mes de licence.

Au lieu de lancer OpenTTD par <code>$ ./openttd</code>, vous pouvez simplement entrer <code>$ openttd</code> pour le d√©marrer.

Dans l'√©tape 5, vous devez copier les fichiers de musique du r√©pertoire gm dans <code>/usr/share/games/openttd</code>.